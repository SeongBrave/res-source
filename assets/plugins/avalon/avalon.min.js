!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("Avalon requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){function h(){a.console&&avalon.config.debug&&Function.apply.call(console.log,console,arguments)}function z(){}function A(a,b){var c,d,e,f;for("string"==typeof a&&(a=a.match(k)||[]),c={},d=void 0!==b?b:1,e=0,f=a.length;f>e;e++)c[a[e]]=d;return c}function C(){if(a.VBArray){var b=document.documentMode;return b?b:a.XMLHttpRequest?7:6}return 0/0}function F(a){return n.test(q.call(a))}function I(a,b){return a=Math.floor(a)||0,0>a?Math.max(b+a,0):Math.min(a,b)}function L(a){var b,c;if(!a)return!1;if(b=a.length,b===b>>>0){if(c=q.call(a).slice(8,-1),/(?:regexp|string|function|window|global)$/i.test(c))return!1;if("Array"===c)return!0;try{return{}.propertyIsEnumerable.call(a,"length")===!1?/^\s?function/.test(a.item||a.callee):!0}catch(d){return!a.window}}return!1}function S(a,b,c){var d="for(var "+a+"i=0,n = this.length; i < n; i++){"+b.replace("_","((i in this) && fn.call(scope,this[i],i,this))")+"}"+c;return Function("fn,scope",d)}function T(a,b){try{for(;b=b.parentNode;)if(b===a)return!0;return!1}catch(c){return!1}}function U(){return(new XMLSerializer).serializeToString(this)}function X(a,b){var c,f,e,g;if(a&&a.childNodes)for(c=a.childNodes,e=0;f=c[e++];)f.tagName&&(g=d.createElementNS(V,f.tagName.toLowerCase()),r.forEach.call(f.attributes,function(a){g.setAttribute(a.name,a.value)}),X(f,g),b.appendChild(g))}function Z(a){var c,e,f,g,b={};for(c in a)b[c]=a[c];return e=b.target=a.srcElement,0===a.type.indexOf("key")?b.which=null!=a.charCode?a.charCode:a.keyCode:Y.test(a.type)&&(f=e.ownerDocument||d,g="BackCompat"===f.compatMode?f.body:f.documentElement,b.pageX=a.clientX+(g.scrollLeft>>0)-(g.clientLeft>>0),b.pageY=a.clientY+(g.scrollTop>>0)-(g.clientTop>>0),b.wheelDeltaY=b.wheelDelta,b.wheelDeltaX=0),b.timeStamp=new Date-0,b.originalEvent=a,b.preventDefault=function(){a.returnValue=!1},b.stopPropagation=function(){a.cancelBubble=!0},b}function bb(a){var b,c;for(b in a)p.call(a,b)&&(c=a[b],"function"==typeof bb.plugins[b]?bb.plugins[b](c):"object"==typeof bb[b]?avalon.mix(bb[b],c):bb[b]=c);return this}function ib(a){return(a+"").replace(hb,"\\$&")}function tb(a,b,c){var d,e,f,g,h,i,j,k,m,n;if(Array.isArray(a))return d=a.concat(),a.length=0,e=Hb(a),e.pushArray(d),e;if(!a||a.nodeType>0||a.$id&&a.$events)return a;for(f=Array.isArray(a.$skipArray)?a.$skipArray:[],f.$special=b||{},g={},c=c||{},h={},i={},j=[],ob.forEach(function(b){delete a[b]}),k=Object.keys(a),k.forEach(function(b,d){var g,e=a[b];c[b]=e,Cb(b,e,f)&&(h[b]=[],g=avalon.type(e),"object"===g&&E(e.get)&&Object.keys(e).length<=2?(d=wb(b,e),j.push(d)):d=l.test(g)?xb(b,e,g,h[b],c):vb(b,e),i[b]=d)}),g=rb(g,Eb(i),a),m=0;m<k.length;m++)n=k[m],i[n]||(g[n]=a[n]);ub(g,"$id",B()),ub(g,"$model",c),ub(g,"$events",h),qb?ub(g,"hasOwnProperty",function(a){return a in g.$model}):g.hasOwnProperty=function(a){return a in g.$model&&"hasOwnProperty"!==a};for(m in mb)ub(g,m,mb[m].bind(g));return g.$reinitialize=function(){j.forEach(function(a){delete a._value,delete a.oldArgs,a.digest=function(){a.call(g)},Nb.begin({callback:function(b,c){var e,d=c._name;c!==a&&(e=b.$events[d],Pb(e,a.digest))}});try{a.get.call(g)}finally{Nb.end()}})},g.$reinitialize(),g}function ub(a,b,c){qb?Object.defineProperty(a,b,{value:c,writable:!0,enumerable:!1,configurable:!0}):a[b]=c}function vb(a,b){function c(a){var b=c._value;return arguments.length>0?(j||Bb(a,b)||(c.updateValue(this,a),c.notify(this,a,b)),this):(Nb.collectDependency(this,c),b)}return Ab(c,a),c._value=b,c}function wb(a,b){function c(b){var f,g,d=c._value,e="_value"in c;return arguments.length>0?j?this:("function"==typeof c.set&&c.oldArgs!==b&&(c.oldArgs=b,f=this.$events,g=f[a],f[a]=[],c.set.call(this,b),f[a]=g,b=c.get.call(this),b!==d&&(c.updateValue(this,b),c.notify(this,b,d))),this):(b=c.get.call(this),c.updateValue(this,b),e&&d!==b&&c.notify(this,b,d),b)}return c.set=b.set,c.get=b.get,Ab(c,a),c}function xb(a,b,c,d,e){function f(b){var g,h,k,l,m,n,o,q,d=f._value,e=f._vmodel;if(arguments.length>0){if(j)return this;if("array"===c){for(g=e,h=b,k=g.length,l=h.length,g.$lock=!0,k>l?g.splice(l,k-l):l>k&&g.push.apply(g,h.slice(k)),m=Math.min(k,l),n=0;m>n;n++)g.set(n,h[n]);delete g.$lock,g._fire("set")}else if("object"===c){o=this.$events[a]||[],q=avalon.mix(!0,{},b);for(n in e)e.hasOwnProperty(n)&&p.call(q,n)&&(e[n]=q[n]);e=f._vmodel=tb(b),e.$events[i]=o,o.length&&o.forEach(function(a){a.type&&(a.rollback&&a.rollback(),J[a.type](a,a.vmodels))})}return f.updateValue(this,e.$model),f.notify(this,this._value,d),this}return Nb.collectDependency(this,f),e}Ab(f,a),e[a]=Array.isArray(b)?b:e[a]||{};var g=f._vmodel=tb(b,0,e[a]);return g.$events[i]=d,f}function yb(a,b){a.$model[this._name]=this._value=b}function zb(a,b,c){var d=this._name,e=a.$events[d];e&&(Qb(e),mb.$fire.call(a,d,b,c))}function Ab(a,b){a._name=b,a.updateValue=yb,a.notify=zb}function Cb(a,b,c){if(E(b)||b&&b.nodeType)return!1;if(-1!==c.indexOf(a))return!1;var d=c.$special;return a&&"$"===a.charAt(0)&&!d[a]?!1:!0}function Db(a){var c,d,b=Object.keys(a.$model?a.$model:a);for(c=0;c<ob.length;c++)d=b.indexOf(ob[c]),-1!==d&&b.splice(d,1);return b}function Gb(a,b,c,d){var e=b[c];return 4!==arguments.length?e.call(a):(e.call(a,d),void 0)}function Hb(a){var c,b=[];b.$id=B(),b.$model=a,b.$events={},b.$events[i]=[],b._=tb({length:a.length}),b._.$watch("length",function(a,c){b.$fire("length",a,c)});for(c in mb)b[c]=mb[c];return avalon.mix(b,Kb),b}function Ib(a,b,c,d,e,f,g){for(var j,k,h=this.length,i=2;--i;){switch(a){case"add":j=this.$model.slice(b,b+c).map(function(a){return l.test(avalon.type(a))?a.$id?a:tb(a,0,a):a}),Jb.apply(this,[b,0].concat(j)),this._fire("add",b,c);break;case"del":k=this._splice(b,c),this._fire("del",b,c)}e&&(a=e,b=f,c=g,i=2,e=0)}return this._fire("index",d),this.length!==h&&(this._.length=this.length),k}function Mb(a,b){var d,e,f,c={};for(d=0,e=b.length;e>d;d++)c[d]=a[d],f=b[d],f in c?(a[d]=c[f],delete c[f]):a[d]=a[f]}function Pb(a,b){b.oneTime||a&&avalon.Array.ensure(a,b)&&b.element&&(Wb(b,a),new Date-Tb>444&&Xb())}function Qb(a){var b,d,c,e,f,g;if(a&&a.length)for(new Date-Tb>444&&"object"==typeof a[0]&&Xb(),b=s.call(arguments,1),c=a.length;d=a[--c];)if(e=d.element,e&&e.parentNode)try{f=d.evaluator,d.$repeat?d.handler.apply(d,b):"$repeat"in d||!f?J[d.type](d,d.vmodels):"on"!==d.type&&(g=f.apply(0,d.args||[]),d.handler(g,e,d))}catch(h){console.log(h)}}function Vb(a,b){return a.uuid||b||(a.uuid=++Rb),a.uuid}function Wb(a,b){var d,c=a.element;a.uuid||(a.uuid=1!==c.nodeType?a.type+Vb(c.parentNode)+"-"+ ++Rb:a.name+"-"+Vb(c)),d=a.lists||(a.lists=[]),avalon.Array.ensure(d,b),b.$uuid=b.$uuid||B(),Sb[a.uuid]||(Sb[a.uuid]=1,Sb.push(a))}function Xb(a){var b,c,d,e,f,g,h,i,k,j;if(!avalon.optimize){for(b=Sb.length,c=b,d=[],e={},f={};a=Sb[--b];)g=a.type,f[g]?f[g]++:(f[g]=1,d.push(g));if(h=!1,d.forEach(function(a){Ub[a]!==f[a]&&(e[a]=1,h=!0)}),b=c,h)for(;a=Sb[--b];)if(null!==a.element){if(e[a.type]&&Zb(a.element)){for(Sb.splice(b,1),delete Sb[a.uuid],i=a.lists,j=0;k=i[j++];)avalon.Array.remove(i,k),avalon.Array.remove(k,a);Yb(a)}}else Sb.splice(b,1);Ub=f,Tb=new Date}}function Yb(a){delete Sb[a.uuid],a.element=null,a.rollback&&a.rollback();for(var b in a)a[b]=null}function Zb(a){try{a.parentNode.nodeType}catch(c){return!0}return a.ifRemove&&!v.contains(a.ifRemove)&&f===a.parentNode?(a.parentNode&&a.parentNode.removeChild(a),!0):a.msRetain?0:1===a.nodeType?!v.contains(a):!avalon.contains(v,a)}function gc(a){var b=a.nodeName;return b.toLowerCase()===b&&a.scopeName&&""===a.outerText}function hc(a){"url(#default#VML)"!==a.currentStyle.behavior&&(a.style.behavior="url(#default#VML)",a.style.display="inline-block",a.style.zoom=1)}function ic(a){return a.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").toLowerCase()}function jc(a){return!a||a.indexOf("-")<0&&a.indexOf("_")<0?a:a.replace(/[-_][^-_]/g,function(a){return a.charAt(1).toUpperCase()})}function lc(a){if(!("classList"in a)){a.classList={node:a};for(var b in kc)a.classList[b.slice(1)]=kc[b]}return a.classList}function mc(a){try{if("object"==typeof a)return a;a="true"===a?!0:"false"===a?!1:"null"===a?null:+a+""===a?+a:nc.test(a)?avalon.parseJSON(a):a}catch(b){}return a}function sc(a){return a.window&&a.document?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}function Ec(a,b){var c,d,e;if(a.offsetWidth<=0){if(Dc.test(tc["@:get"](a,"display"))){c={node:a};for(d in Cc)c[d]=a.style[d],a.style[d]=Cc[d];b.push(c)}e=a.parentNode,e&&1===e.nodeType&&Ec(e,b)}}function Fc(a){var b=a.tagName.toLowerCase();return"input"===b&&/checkbox|radio/.test(a.type)?"checked":b}function Sc(a,b,c,d){var h,g,e=[],f=" = "+c+".";for(g=a.length;h=a[--g];)b.hasOwnProperty(h)&&(e.push(h+f+h),d.vars.push(h),"duplex"===d.type&&(a.get=c+"."+h),a.splice(g,1));return e}function Tc(a){var d,e,f,b=[],c={};for(d=0;d<a.length;d++)e=a[d],f=e&&"string"==typeof e.$id?e.$id:e,c[f]||(c[f]=b.push(e));return b}function ad(a,b){return b=b.replace(Xc,"").replace(Yc,function(){return"],|"}).replace(Zc,function(a,b){return"["+Jc(b)}).replace($c,function(){return'"],["'}).replace(_c,function(){return'",'})+"]","return this.filters.$filter("+a+", "+b+")"}function bd(a,b,d){var n,o,p,q,s,t,u,v,e=d.type,f=d.filters||"",g=b.map(function(a){return String(a.$id).replace(Wc,"$1")})+a+e+f,i=Rc(a).concat(),j=[],k=[],l=[],m="";for(b=Tc(b),d.vars=[],n=0,o=b.length;o>n;n++)i.length&&(p="vm"+c+"_"+n,k.push(p),l.push(b[n]),j.push.apply(j,Sc(i,b[n],p,d)));if(j.length||"duplex"!==e){if("duplex"!==e&&(a.indexOf("||")>-1||a.indexOf("&&")>-1)&&d.vars.forEach(function(b){var c=new RegExp("\\b"+b+"(?:\\.\\w+|\\[\\w+\\])+","ig");a=a.replace(c,function(c,d){var h,i,k,e=c.charAt(b.length),f=a.slice(d+c.length),g=/^\s*\(/.test(f);return"."===e||"["===e||g?(h="var"+String(Math.random()).replace(/^0\./,""),g?(i=c.split("."),i.length>2?(k=i.pop(),j.push(h+" = "+i.join(".")),h+"."+k):c):(j.push(h+" = "+c),h)):c})}),d.args=l,delete d.vars,q=Uc.get(g))return d.evaluator=q,void 0;if(m=j.join(", "),m&&(m="var "+m),/\S/.test(f)){if(!/text|html/.test(d.type))throw Error("ms-"+d.type+"不支持过滤器");a="\nvar ret"+c+" = "+a+";\r\n",a+=ad("ret"+c,f);try{q=Function.apply(z,k.concat("'use strict';\n"+m+a)),d.evaluator=Uc.put(g,function(){return q.apply(avalon,arguments)})}catch(r){h("debug: parse error,"+r.message)}return i=j=k=null,void 0}if("duplex"===e){s="'use strict';\nreturn function(vvv){\n	"+m+";\n	if(!arguments.length){\n		return "+a+"\n	}\n	"+(Vc.test(a)?a:i.get)+"= vvv;\n} ";try{q=Function.apply(z,k.concat(s)),d.evaluator=Uc.put(g,q)}catch(r){h("debug: parse error,"+r.message)}return i=j=k=null,void 0}"on"===e?(-1===a.indexOf("(")?a+=".call(this, $event)":a=a.replace("(",".call(this,"),k.push("$event"),a="\nreturn "+a+";",t=a.lastIndexOf("\nreturn"),u=a.slice(0,t),v=a.slice(t),a=u+"\n"+v):a="\nreturn "+a+";";try{q=Function.apply(z,k.concat("'use strict';\n"+m+a)),d.evaluator=Uc.put(g,q)}catch(r){h("debug: parse error,"+r.message)}i=j=k=null}}function cd(a){var c,b=eb.test(a);return b?(c=Id(a),1===c.length?c[0].value:c.map(function(a){return a.expr?"("+a.value+")":Jc(a.value)}).join(" + ")):a}function dd(a,b,c,d){a=a||"",bd(a,b,c),c.evaluator&&!d&&(c.handler=K[c.handlerName||c.type],avalon.injectBinding(c))}function fd(a,b,c){var d=setTimeout(function(){var e=a.innerHTML;clearTimeout(d),e===c?b():fd(a,b,e)})}function gd(a,b){var c=a.getAttribute("avalonctrl")||b.$id;a.setAttribute("avalonctrl",c),b.$events.expr=a.tagName+'[avalonctrl="'+c+'"]'}function id(a,b){for(var d,c=0;d=a[c++];)d.vmodels=b,J[d.type](d,b),d.evaluator&&d.element&&1===d.element.nodeType&&d.element.removeAttribute(d.name);a.length=0}function pd(a,b){return a.priority-b.priority}function qd(a,b,c){var e,f,g,i,j,l,k,m,n,o,p,q,r,s,t,u,d=!0;if(b.length){for(e=yd?yd(a):a.attributes,f=[],g=[],i={},j={},k=0;l=e[k++];)if(l.specified&&(c=l.name.match(ld))){if(m=c[1],n=c[2]||"",o=l.value,p=l.name,j[p])continue;j[p]=1,nd[m]?(n=m,m="on"):od[m]&&("enabled"===m&&(h("warning!ms-enabled或ms-attr-enabled已经被废弃"),m="disabled",o="!("+o+")"),n=m,m="attr",p="ms-"+m+"-"+n,g.push([l.name,p,o])),i[p]=o,"function"==typeof J[m]&&(q=o.replace(kd,""),r=o!==q,s={type:m,param:n,element:a,name:p,value:q,oneTime:r,uuid:p+"-"+Vb(a),priority:(md[m]||10*m.charCodeAt(0))+(Number(n.replace(/\D/g,""))||0)},"html"===m||"text"===m?(t=Hd(o),avalon.mix(s,t),s.filters=s.filters.replace(Cd,function(){return s.type="html",s.group=1,""})):"duplex"===m?u=p:"ms-if-loop"===p&&(s.priority+=100),f.push(s),"widget"===m&&(a.msData=a.msData||i))}if(f.length){for(f.sort(pd),g.forEach(function(b){h("warning!请改用"+b[1]+"代替"+b[0]+"!"),a.removeAttribute(b[0]),a.setAttribute(b[1],b[2])}),u&&i["ms-attr-value"]&&!a.scopeName&&"text"===a.type&&h("warning!一个控件不能同时定义ms-attr-value与"+u),k=0;s=f[k];k++){if(m=s.type,rd.test(m))return id(f.slice(0,k+1),b);d&&(d=!sd.test(m))}id(f,b)}}d&&!ed[a.tagName]&&gb.test(a.innerHTML.replace(Ed,"<").replace(Fd,">"))&&(jd&&jd(a),zd(a,b))}function zd(a,b){var c=avalon.slice(a.childNodes);Ad(c,b)}function Ad(a,b){for(var d,c=0;d=a[c++];)switch(d.nodeType){case 1:Bd(d,b),d.msCallback&&(d.msCallback(),d.msCallback=void 0);break;case 3:eb.test(d.nodeValue)&&Jd(d,b,c)}}function Bd(a,b,c){var e,f,g,i,d=a.getAttribute("ms-skip");if(!a.getAttributeNode)return h("warning "+a.tagName+" no getAttributeNode method");if(e=a.getAttributeNode("ms-important"),f=a.getAttributeNode("ms-controller"),"string"!=typeof d){if(c=e||f){if(g=avalon.vmodels[c.value],!g)return;b=c===e?[g]:[g].concat(b),i=c.name,a.removeAttribute(i),avalon(a).removeClass(i),gd(a,g)}qd(a,b)}}function Hd(a){var b,c;return a.indexOf("|")>0&&(b=a.replace(Gd,function(a){return Array(a.length+1).join("1")}),c=b.replace(Dd,"ᄢ㍄").indexOf("|"),c>-1)?{filters:a.slice(c),value:a.slice(0,c),expr:!0}:{value:a,filters:"",expr:!0}}function Id(a){for(var c,e,b=[],d=0;;){if(e=a.indexOf(cb,d),-1===e)break;if(c=a.slice(d,e),c&&b.push({value:c,filters:"",expr:!1}),d=e+cb.length,e=a.indexOf(db,d),-1===e)break;c=a.slice(d,e),c&&b.push(Hd(c)),d=e+db.length}return c=a.slice(d),c&&b.push({value:c,expr:!1,filters:""}),b}function Jd(a,b){var g,f,h,c=[],e=Id(a.data);if(e.length){for(f=0;g=e[f++];)h=d.createTextNode(g.value),g.expr&&(g.value=g.value.replace(kd,function(){return g.oneTime=!0,""}),g.type="text",g.element=h,g.filters=g.filters.replace(Cd,function(){return g.type="html",""}),c.push(g)),w.appendChild(h);a.parentNode.replaceChild(w,a),c.length&&id(c,b)}}function Sd(a,b,c){var g,f,e=a.templateCache&&a.templateCache[b];if(e){for(f=d.createDocumentFragment();g=e.firstChild;)f.appendChild(g);return f}return avalon.parseHTML(c)}function Ud(a){return null==a?"":a}function Vd(a,b,c){return b.param.replace(/\w+/g,function(d){var e=avalon.duplexHooks[d];e&&"function"==typeof e[c]&&(a=e[c](a,b))}),a}function Yd(){var a,b;for(a=Xd.length-1;a>=0;a--)b=Xd[a],b()===!1&&Xd.splice(a,1);Xd.length||clearInterval(Wd)}function _d(a,b,c,e){var h,i,f=a.template.cloneNode(!0),g=avalon.slice(f.childNodes);f.insertBefore(d.createComment(a.signature),f.firstChild),b.appendChild(f),h=[c].concat(a.vmodels),i={nodes:g,vmodels:h},e.push(i)}function ae(a){var e,d,b=[],c=a.element.parentNode.childNodes;for(d=0;e=c[d++];)if(e.nodeValue===a.signature)b.push(e);else if(e.nodeValue===a.signature+":end")break;return b}function be(a,b,c){for(;;){var d=b.previousSibling;if(!d)break;if(d.parentNode.removeChild(d),c&&c.call(d),d===a)break}}function de(){var a=tb({$key:"",$outer:{},$host:{},$val:{get:function(){return this.$host[this.$key]},set:function(a){this.$host[this.$key]=a}}},{$val:1});return a.$id=B("$proxy$with"),a}function ee(a,b,c){a=a||ce.pop(),a?a.$reinitialize():a=de();var d=c.$repeat;return a.$key=b,a.$host=d,a.$outer=c.$outer,d.$events?a.$events.$val=d.$events[b]:a.$events={},a}function fe(a){ge(a)}function ge(a){a.forEach(function(a){ke(a,he)}),a.length=0}function ie(a){var c,d,b={$host:[],$outer:{},$index:0,$first:!1,$last:!1,$remove:avalon.noop};return b[a]={get:function(){var b=this.$events,c=b.$index;b.$index=b[a];try{return this.$host[this.$index]}finally{b.$index=c}},set:function(a){var b,c;try{b=this.$events,c=b.$index,b.$index=[],this.$host.set(this.$index,a)}finally{b.$index=c}}},c={$last:1,$first:1,$index:1},d=tb(b,c),d.$id=B("$proxy$each"),d}function je(a,b){var d,e,f,g,h,i,c=b.param||"el";for(e=0,f=he.length;f>e;e++)g=he[e],g&&g.hasOwnProperty(c)&&(d=g,he.splice(e,1));return d||(d=ie(c)),h=b.$repeat,i=h.length-1,d.$index=a,d.$first=0===a,d.$last=a===i,d.$host=h,d.$outer=b.$outer,d.$remove=function(){return h.removeAt(d.$index)},d}function ke(a,b){var c,d;for(c in a.$events)d=a.$events[c],Array.isArray(d)&&(d.forEach(function(a){"object"==typeof a&&Yb(a)}),d.length=0);a.$host=a.$outer={},b.unshift(a)>bb.maxRepeatSize&&b.pop()}function le(a,b){var e,c="_"+a;return le[c]||(e=d.createElement(a),v.appendChild(e),b=u?getComputedStyle(e,null).display:e.currentStyle.display,v.removeChild(e),le[c]=b),le[c]}function te(a,b,c,d){a=(a+"").replace(/[^0-9+\-Ee.]/g,"");var e=isFinite(+a)?+a:0,f=isFinite(+b)?Math.abs(b):3,g=d||",",h=c||".",i="",j=function(a,b){var c=Math.pow(10,b);return""+(Math.round(a*c)/c).toFixed(b)};return i=(f?j(e,f):""+Math.round(e)).split("."),i[0].length>3&&(i[0]=i[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,g)),(i[1]||"").length<f&&(i[1]=i[1]||"",i[1]+=new Array(f-i[1].length+1).join("0")),i.join(h)}var g,i,j,k,l,m,n,o,p,q,r,s,u,v,w,x,y,B,D,E,G,H,J,K,M,N,O,P,Q,R,V,W,Y,$,_,ab,cb,db,eb,fb,gb,hb,jb,kb,lb,mb,nb,ob,pb,qb,rb,Bb,Eb,Fb,Jb,Kb,Nb,Ob,Rb,Sb,Tb,Ub,$b,_b,ac,bc,cc,dc,ec,fc,kc,nc,oc,pc,qc,rc,tc,uc,vc,wc,xc,yc,zc,Ac,Bc,Cc,Dc,Gc,Hc,Ic,Jc,Kc,Lc,Mc,Nc,Oc,Pc,Qc,Rc,Uc,Vc,Wc,Xc,Yc,Zc,$c,_c,ed,hd,jd,kd,ld,md,nd,od,rd,sd,td,ud,vd,wd,xd,yd,Cd,Dd,Ed,Fd,Gd,Kd,Ld,Md,Nd,Od,Pd,Qd,Rd,Td,Wd,Xd,Zd,$d,ce,he,me,ne,oe,pe,qe,re,se,ue,ve,c=new Date-0,d=a.document,e=d.getElementsByTagName("head")[0],f=e.insertBefore(document.createElement("avalon"),e.firstChild);f.innerHTML="X<style id='avalonStyle'>.avalonHide{ display: none!important }</style>",f.setAttribute("ms-skip","1"),f.className="avalonHide",g=/\[native code\]/,i="$"+c,j=!1,k=/[^, ]+/g,l=/^(?:object|array)$/,m=/^\[object SVG\w*Element\]$/,n=/^\[object (?:Window|DOMWindow|global)\]$/,o=Object.prototype,p=o.hasOwnProperty,q=o.toString,r=Array.prototype,s=r.slice,u=a.dispatchEvent,v=d.documentElement,w=d.createDocumentFragment(),x=d.createElement("div"),y={},"Boolean Number String Function Array Date RegExp Object Error".replace(k,function(a){y["[object "+a+"]"]=a.toLowerCase()}),B=function(a){return a=a||"avalon",String(Math.random()+Math.random()).replace(/\d\.\d{4}/,a)},D=C(),avalon=function(a){return new avalon.init(a)},avalon.profile=function(){a.console&&avalon.config.profile&&Function.apply.call(console.log,console,arguments)},avalon.nextTick=new function(){function g(){var b,a=f.length;for(b=0;a>b;b++)f[b]();f=f.slice(a)}var f,h,b=a.setImmediate,c=a.MutationObserver;return b?b.bind(a):(f=[],c?(h=document.createTextNode("avalon"),new c(g).observe(h,{characterData:!0}),function(a){f.push(a),h.data=Math.random()}):a.VBArray?function(a){f.push(a);var b=d.createElement("script");b.onreadystatechange=function(){g(),b.onreadystatechange=null,e.removeChild(b),b=null},e.appendChild(b)}:function(a){setTimeout(a,4)})},avalon.init=function(a){this[0]=this.element=a},avalon.fn=avalon.prototype=avalon.init.prototype,avalon.type=function(a){return null==a?String(a):"object"==typeof a||"function"==typeof a?y[q.call(a)]||"object":typeof a},E="object"==typeof alert?function(a){try{return/^\s*\bfunction\b/.test(a+"")}catch(b){return!1}}:function(a){return"[object Function]"===q.call(a)},avalon.isFunction=E,avalon.isWindow=function(a){return a?a==a.document&&a.document!=a:!1},F(a)&&(avalon.isWindow=F);for(G in avalon({}))break;H="0"!==G,avalon.isPlainObject=function(a,b){if(!a||"object"!==avalon.type(a)||a.nodeType||avalon.isWindow(a))return!1;try{if(a.constructor&&!p.call(a,"constructor")&&!p.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}if(H)for(b in a)return p.call(a,b);for(b in a);return void 0===b||p.call(a,b)},g.test(Object.getPrototypeOf)&&(avalon.isPlainObject=function(a){return"[object Object]"===q.call(a)&&Object.getPrototypeOf(a)===o}),avalon.mix=avalon.fn.mix=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[1]||{},h++),"object"==typeof g||E(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a){c=g[b];try{d=a[b]}catch(k){continue}g!==d&&(j&&d&&(avalon.isPlainObject(d)||(e=Array.isArray(d)))?(e?(e=!1,f=c&&Array.isArray(c)?c:[]):f=c&&avalon.isPlainObject(c)?c:{},g[b]=avalon.mix(j,f,d)):void 0!==d&&(g[b]=d))}return g},avalon.mix({rword:k,subscribers:i,version:1.47,ui:{},log:h,slice:u?function(a,b,c){return s.call(a,b,c)}:function(a,b,c){var f,d=[],e=a.length;if(void 0===c&&(c=e),"number"==typeof c&&isFinite(c))for(b=I(b,e),c=I(c,e),f=b;c>f;++f)d[f-b]=a[f];return d},noop:z,error:function(a,b){throw(b||Error)(a)},oneObject:A,range:function(a,b,c){c||(c=1),null==b&&(b=a||0,a=0);for(var d=-1,e=Math.max(0,Math.ceil((b-a)/c)),f=new Array(e);++d<e;)f[d]=a,a+=c;return f},eventHooks:[],bind:function(a,b,c,d){var g,e=avalon.eventHooks,f=e[b];return"object"==typeof f&&(b=f.type||b,d=f.phase||!!d,c=f.fn?f.fn(a,c):c),g=u?c:function(b){c.call(a,Z(b))},u?a.addEventListener(b,g,d):a.attachEvent("on"+b,g),g},unbind:function(a,b,c,d){var e=avalon.eventHooks,f=e[b],g=c||z;"object"==typeof f&&(b=f.type||b,d=f.phase||!!d),u?a.removeEventListener(b,g,d):a.detachEvent("on"+b,g)},css:function(a,b,c){var e,d,f;if(a instanceof avalon&&(a=a[0]),d=/[_-]/.test(b)?jc(b):b,b=avalon.cssName(d)||d,void 0===c||"boolean"==typeof c)return e=tc[d+":get"]||tc["@:get"],"background"===b&&(b="backgroundColor"),f=e(a,b),c===!0?parseFloat(f)||0:f;if(""===c)a.style[b]="";else{if(null==c||c!==c)return;isFinite(c)&&!avalon.cssNumber[d]&&(c+="px"),e=tc[d+":set"]||tc["@:set"],e(a,b,c)}},each:function(a,b){var c,d;if(a)if(c=0,L(a))for(d=a.length;d>c&&b(c,a[c])!==!1;c++);else for(c in a)if(a.hasOwnProperty(c)&&b(c,a[c])===!1)break},getWidgetData:function(a,b){var e,c=avalon(a).data(),d={};for(e in c)0===e.indexOf(b)&&(d[e.replace(b,"").replace(/\w/,function(a){return a.toLowerCase()})]=c[e]);return d},Array:{ensure:function(a,b){return-1===a.indexOf(b)?a.push(b):void 0},removeAt:function(a,b){return!!a.splice(b,1).length},remove:function(a,b){var c=a.indexOf(b);return~c?avalon.Array.removeAt(a,c):!1}}}),J=avalon.bindingHandlers={},K=avalon.bindingExecutors={},M=new function(){function a(a){this.size=0,this.limit=a,this.head=this.tail=void 0,this._keymap={}}var b=a.prototype;return b.put=function(a,b){var c={key:a,value:b};return this._keymap[a]=c,this.tail?(this.tail.newer=c,c.older=this.tail):this.head=c,this.tail=c,this.size===this.limit?this.shift():this.size++,b},b.shift=function(){var a=this.head;a&&(this.head=this.head.newer,this.head.older=a.newer=a.older=this._keymap[a.key]=void 0,delete this._keymap[a.key])},b.get=function(a){var b=this._keymap[a];if(void 0!==b)return b===this.tail?b.value:(b.newer&&(b===this.head&&(this.head=b.newer),b.newer.older=b.older),b.older&&(b.older.newer=b.newer),b.newer=void 0,b.older=this.tail,this.tail&&(this.tail.newer=b),this.tail=b,b.value)},a},"司徒正美".trim||(N=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,String.prototype.trim=function(){return this.replace(N,"")}),O=!{toString:null}.propertyIsEnumerable("toString"),P=function(){}.propertyIsEnumerable("prototype"),Q=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],R=Q.length,Object.keys||(Object.keys=function(a){var d,e,f,g,h,i,b=[],c=P&&"function"==typeof a;if("string"==typeof a||a&&a.callee)for(d=0;d<a.length;++d)b.push(String(d));else for(e in a)c&&"prototype"===e||!p.call(a,e)||b.push(String(e));if(O)for(f=a.constructor,g=f&&f.prototype===a,h=0;R>h;h++)i=Q[h],g&&"constructor"===i||!p.call(a,i)||b.push(i);return b}),Array.isArray||(Array.isArray=function(a){return"[object Array]"===q.call(a)}),z.bind||(Function.prototype.bind=function(a){if(arguments.length<2&&void 0===a)return this;var b=this,c=arguments;return function(){var e,d=[];for(e=1;e<c.length;e++)d.push(c[e]);for(e=0;e<arguments.length;e++)d.push(arguments[e]);return b.apply(a,d)}}),g.test([].map)||avalon.mix(r,{indexOf:function(a,b){var c=this.length,d=~~b;for(0>d&&(d+=c);c>d;d++)if(this[d]===a)return d;return-1},lastIndexOf:function(a,b){var c=this.length,d=null==b?c-1:b;for(0>d&&(d=Math.max(0,c+d));d>=0;d--)if(this[d]===a)return d;return-1},forEach:S("","_",""),filter:S("r=[],j=0,","if(_)r[j++]=this[i]","return r"),map:S("r=[],","r[i]=_","return r"),some:S("","if(_)return true","return false"),every:S("","if(!_)return false","return true")}),avalon.contains=T,d.contains||(d.contains=function(a){return T(d,a)}),a.SVGElement&&(d.createTextNode("x").contains||(Node.prototype.contains=function(a){return!!(16&this.compareDocumentPosition(a))}),V="http://www.w3.org/2000/svg",W=d.createElementNS(V,"svg"),W.innerHTML='<circle cx="50" cy="50" r="40" fill="red" />',m.test(W.firstChild)||Object.defineProperties(SVGElement.prototype,{outerHTML:{enumerable:!0,configurable:!0,get:U,set:function(a){var f,b=this.tagName.toLowerCase(),c=this.parentNode,e=avalon.parseHTML(a);"svg"===b?c.insertBefore(e,this):(f=d.createDocumentFragment(),X(e,f),c.insertBefore(f,this)),c.removeChild(this)}},innerHTML:{enumerable:!0,configurable:!0,get:function(){var a=this.outerHTML,b=new RegExp("<"+this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i"),c=new RegExp("</"+this.nodeName+">$","i");return a.replace(b,"").replace(c,"")},set:function(a){if(avalon.clearHTML){avalon.clearHTML(this);var b=avalon.parseHTML(a);X(b,this)}}}})),!v.outerHTML&&a.HTMLElement&&HTMLElement.prototype.__defineGetter__("outerHTML",U),Y=/^(?:mouse|contextmenu|drag)|click/,$=avalon.eventHooks,"onmouseenter"in v||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){$[a]={type:b,fn:function(b,c){return function(d){var e=d.relatedTarget;return e&&(e===b||16&b.compareDocumentPosition(e))?void 0:(delete d.type,d.type=a,c.call(b,d))}}}}),avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(b,c){a[b]&&!$.animationend&&($.animationend={type:c})}),"oninput"in d.createElement("input")||($.input={type:"propertychange",fn:function(a,b){return function(c){return"value"===c.propertyName?(c.type="input",b.call(a,c)):void 0}}}),void 0===d.onmousewheel&&(_=void 0!==d.onwheel?"wheel":"DOMMouseScroll",ab="wheel"===_?"deltaY":"detail",$.mousewheel={type:_,fn:function(a,b){return function(c){c.wheelDeltaY=c.wheelDelta=c[ab]>0?-120:120,c.wheelDeltaX=0,Object.defineProperty&&Object.defineProperty(c,"type",{value:"mousewheel"}),b.call(a,c)}}}),hb=/[-.*+?^${}()|[\]\/\\]/g,jb={interpolate:function(a){var b,c,d;if(cb=a[0],db=a[1],cb===db)throw new SyntaxError("openTag===closeTag");if(b=cb+"test"+db,x.innerHTML=b,x.innerHTML!==b&&x.innerHTML.indexOf("&lt;")>-1)throw new SyntaxError("此定界符不合法");bb.openTag=cb,bb.closeTag=db,x.innerHTML="",c=ib(cb),d=ib(db),eb=new RegExp(c+"(.*?)"+d),fb=new RegExp(c+"(.*?)"+d,"g"),gb=new RegExp(c+".*?"+d+"|\\sms-")}},bb.debug=!0,bb.plugins=jb,bb.plugins["interpolate"](["{{","}}"]),bb.paths={},bb.shim={},bb.maxRepeatSize=100,avalon.config=bb,kb=/(\w+)\[(avalonctrl)="(\S+)"\]/,lb=d.querySelectorAll?function(a){return d.querySelectorAll(a)}:function(a){var g,f,b=a.match(kb),c=d.getElementsByTagName(b[1]),e=[];for(f=0;g=c[f++];)g.getAttribute(b[2])===b[3]&&e.push(g);return e},mb={$watch:function(a,b){if("function"==typeof b){var c=this.$events[a];c?c.push(b):this.$events[a]=[b]}else this.$events=this.$watch.backup;return this},$unwatch:function(a,b){var d,e,c=arguments.length;if(0===c)this.$watch.backup=this.$events,this.$events={};else if(1===c)this.$events[a]=[];else for(d=this.$events[a]||[],e=d.length;~--e<0;)if(d[e]===b)return d.splice(e,1);return this},$fire:function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o;if(/^(\w+)!(\S+)$/.test(a)&&(b=RegExp.$1,a=RegExp.$2),g=this.$events)if(h=s.call(arguments,1),i=[a].concat(h),"all"===b)for(c in avalon.vmodels)e=avalon.vmodels[c],e!==this&&e.$fire.apply(e,i);else if("up"===b||"down"===b){if(j=g.expr?lb(g.expr):[],0===j.length)return;for(c in avalon.vmodels)if(e=avalon.vmodels[c],e!==this&&e.$events.expr){if(k=lb(e.$events.expr),0===k.length)continue;r.forEach.call(k,function(a){r.forEach.call(j,function(c){var d="down"===b?c.contains(a):a.contains(c);d&&(a._avalon=e)})})}for(l=d.getElementsByTagName("*"),m=[],r.forEach.call(l,function(a){a._avalon&&(m.push(a._avalon),a._avalon="",a.removeAttribute("_avalon"))}),"up"===b&&m.reverse(),c=0;(f=m[c++])&&f.$fire.apply(f,i)!==!1;);}else{for(n=g[a]||[],o=g.$all||[],c=0;f=n[c++];)E(f)&&f.apply(this,h);for(c=0;f=o[c++];)E(f)&&f.apply(this,arguments)}}},nb=avalon.vmodels={},avalon.define=function(a,b){var d,e,c=a.$id||a;return c||h("warning: vm必须指定$id"),nb[c]&&h("warning: "+c+" 已经存在于avalon.vmodels中"),"object"==typeof a?d=tb(a):(e={$watch:z},b(e),d=tb(e),j=!0,b(d),j=!1),d.$id=c,nb[c]=d},ob=String("$id,$watch,$unwatch,$fire,$events,$model,$skipArray,$reinitialize").match(k),pb=Object.defineProperty,qb=!0;try{pb({},"_",{value:"x"}),rb=Object.defineProperties}catch(sb){qb=!1}return Bb=Object.is||function(a,b){return 0===a&&0===b?1/a===1/b:a!==a?b!==b:a===b},Eb=u?function(a){var c,b={};for(c in a)b[c]={get:a[c],set:a[c],enumerable:!0,configurable:!0};return b}:function(a){return a},qb||("__defineGetter__"in avalon&&(pb=function(a,b,c){return"value"in c&&(a[b]=c.value),"get"in c&&a.__defineGetter__(b,c.get),"set"in c&&a.__defineSetter__(b,c.set),a},rb=function(a,b){for(var c in b)b.hasOwnProperty(c)&&pb(a,c,b[c]);return a}),D&&(Fb={},a.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function"].join("\n"),"VBScript"),rb=function(b,d,e){var g,h,i,f=[];f.push("\r\n	Private [__data__], [__proxy__]","	Public Default Function [__const__](d"+c+", p"+c+")","		Set [__data__] = d"+c+": set [__proxy__] = p"+c,"		Set [__const__] = Me","	End Function");for(b in e)d.hasOwnProperty(b)||f.push("	Public ["+b+"]");ob.forEach(function(a){d.hasOwnProperty(a)||f.push("	Public ["+a+"]")}),f.push("	Public [hasOwnProperty]");for(b in d)f.push("	Public Property Let ["+b+"](val"+c+")",'		Call [__proxy__](Me,[__data__], "'+b+'", val'+c+")","	End Property","	Public Property Set ["+b+"](val"+c+")",'		Call [__proxy__](Me,[__data__], "'+b+'", val'+c+")","	End Property","	Public Property Get ["+b+"]","	On Error Resume Next","		Set["+b+'] = [__proxy__](Me,[__data__],"'+b+'")',"	If Err.Number <> 0 Then","		["+b+'] = [__proxy__](Me,[__data__],"'+b+'")',"	End If","	On Error Goto 0","	End Property");return f.push("End Class"),g=f.join("\r\n"),h=Fb[g],h||(h=B("VBClass"),a.parseVB("Class "+h+g),a.parseVB(["Function "+h+"Factory(a, b)","	Dim o","	Set o = (New "+h+")(a, b)","	Set "+h+"Factory = o","End Function"].join("\r\n")),Fb[g]=h),i=a[h+"Factory"](d,Gb)})),Jb=r.splice,Kb={_splice:Jb,_fire:function(a,b,c){Qb(this.$events[i],a,b,c)},size:function(){return this._.length},pushArray:function(a){var b=a.length,c=this.length;return b&&(r.push.apply(this.$model,a),Ib.call(this,"add",c,b,Math.max(0,c-1))),b+c},push:function(){var b,a=[],c=arguments.length;for(b=0;c>b;b++)a[b]=arguments[b];return this.pushArray(a)},unshift:function(){var a=arguments.length,b=this.length;return a&&(r.unshift.apply(this.$model,arguments),Ib.call(this,"add",0,a,0)),a+b},shift:function(){if(this.length){var a=this.$model.shift();return Ib.call(this,"del",0,1,0),a}},pop:function(){var b,a=this.length;return a?(b=this.$model.pop(),Ib.call(this,"del",a-1,1,Math.max(0,a-2)),b):void 0},splice:function(a){var d,b=arguments.length,c=[],e=Jb.apply(this.$model,arguments);return e.length&&(c.push("del",a,e.length,0),d=!0),b>2&&(d?c.splice(3,1,0,"add",a,b-2):c.push("add",a,b-2,0),d=!0),d?Ib.apply(this,c):[]},contains:function(a){return-1!==this.indexOf(a)},remove:function(a){return this.removeAt(this.indexOf(a))
},removeAt:function(a){return a>=0?(this.$model.splice(a,1),Ib.call(this,"del",a,1,0)):[]},clear:function(){return this.$model.length=this.length=this._.length=0,this._fire("clear",0),this},removeAll:function(a){var b,c;if(Array.isArray(a))for(b=this.length-1;b>=0;b--)-1!==a.indexOf(this[b])&&this.removeAt(b);else if("function"==typeof a)for(b=this.length-1;b>=0;b--)c=this[b],a(c,b)&&this.removeAt(b);else this.clear()},ensure:function(a){return this.contains(a)||this.push(a),this},set:function(a,b){var c,d,e;if(a<this.length&&a>-1)if(c=avalon.type(b),b&&b.$model&&(b=b.$model),d=this[a],"object"===c)for(e in b)d.hasOwnProperty(e)&&(d[e]=b[e]);else"array"===c?d.clear().push.apply(d,b):d!==b&&(this[a]=b,this.$model[a]=b,this._fire("set",a,b));return this}},"sort,reverse".replace(k,function(a){Kb[a]=function(){var f,g,h,i,j,k,b=this.$model,c=b.concat(),d=Math.random(),e=[];for(r[a].apply(b,arguments),g=0,h=c.length;h>g;g++)i=b[g],j=c[g],Bb(i,j)?e.push(g):(k=c.indexOf(i),e.push(k),c[k]=d,f=!0);return f&&(Mb(this,e),this._fire("move",e),this._fire("index",0)),this}}),Nb=function(){var b,a=[];return{begin:function(c){a.push(b),b=c},end:function(){b=a.pop()},collectDependency:function(a,c){b&&b.callback(a,c)}}}(),Ob=/^(duplex|on)$/,avalon.injectBinding=function(a){var c,f,g,b=a.evaluator;if(b){Nb.begin({callback:function(b,c){Pb(b.$events[c._name],a)}});try{c=Ob.test(a.type)?a:b.apply(0,a.args),void 0===c&&delete a.evaluator,a.handler(c,a.element,a)}catch(e){h("warning:exception throwed in [avalon.injectBinding] ",e),delete a.evaluator,f=a.element,3===f.nodeType&&(g=f.parentNode,bb.commentInterpolate?g.replaceChild(d.createComment(a.value),f):f.data=cb+(a.oneTime?"::":"")+a.value+db)}finally{Nb.end()}}},Rb=0,Sb=avalon.$$subscribers=[],Tb=new Date,Ub={},$b={area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],col:[2,"<table><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],tr:[2,"<table>","</table>"],td:[3,"<table><tr>","</tr></table>"],g:[1,'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">',"</svg>"],_default:u?[0,"",""]:[1,"X<div>","</div>"]},$b.th=$b.td,$b.optgroup=$b.option,$b.tbody=$b.tfoot=$b.colgroup=$b.caption=$b.thead,String("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use").replace(k,function(a){$b[a]=$b.g}),_b=/<([\w:]+)/,ac=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bc=u?/[^\d\D]/:/(<(?:script|link|style|meta|noscript))/gi,cc=A(["","text/javascript","text/ecmascript","application/ecmascript","application/javascript"]),dc=/<(?:tb|td|tf|th|tr|col|opt|leg|cap|area)/,ec=d.createElement("script"),fc=/<|&#?\w+;/,avalon.parseHTML=function(a){var g,h,c,e,f,i,k,j,l,m,b=w.cloneNode(!1);if("string"!=typeof a)return b;if(!fc.test(a))return b.appendChild(d.createTextNode(a)),b;if(a=a.replace(ac,"<$1></$2>").trim(),c=(_b.exec(a)||["",""])[1].toLowerCase(),e=$b[c]||$b._default,f=x,u||(a=a.replace(bc,"<br class=msNoScope>$1")),f.innerHTML=e[1]+a+e[2],i=f.getElementsByTagName("script"),i.length)for(j=0;k=i[j++];)cc[k.type]&&(h=ec.cloneNode(!1),r.forEach.call(k.attributes,function(a){a&&a.specified&&(h[a.name]=a.value,h.setAttribute(a.name,a.value))}),h.text=k.text,k.parentNode.replaceChild(h,k));if(!u){if(l="X<div>"===e[1]?f.lastChild.firstChild:f.lastChild,l&&"TABLE"===l.tagName&&"tbody"!==c)for(i=l.childNodes,j=0;k=i[j++];)if("TBODY"===k.tagName&&!k.innerHTML){l.removeChild(k);break}for(i=f.getElementsByTagName("br"),m=i.length;k=i[--m];)"msNoScope"===k.className&&k.parentNode.removeChild(k);for(i=f.all,j=0;k=i[j++];)gc(k)&&hc(k)}for(j=e[0];j--;f=f.lastChild);for(;g=f.firstChild;)b.appendChild(g);return b},avalon.innerHTML=function(a,b){if(!u&&!bc.test(b)&&!dc.test(b))try{return a.innerHTML=b,void 0}catch(c){}var d=this.parseHTML(b);this.clearHTML(a).appendChild(d)},avalon.clearHTML=function(a){for(a.textContent="";a.firstChild;)a.removeChild(a.firstChild);return a},kc={_toString:function(){var a=this.node,b=a.className,c="string"==typeof b?b:b.baseVal;return c.split(/\s+/).join(" ")},_contains:function(a){return(" "+this+" ").indexOf(" "+a+" ")>-1},_add:function(a){this.contains(a)||this._set(this+" "+a)},_remove:function(a){this._set((" "+this+" ").replace(" "+a+" "," "))},__set:function(a){a=a.trim();var b=this.node;m.test(b)?b.setAttribute("class",a):b.className=a}},"add,remove".replace(k,function(a){avalon.fn[a+"Class"]=function(b){var c=this[0];return b&&"string"==typeof b&&c&&1===c.nodeType&&b.replace(/\S+/g,function(b){lc(c)[a](b)}),this}}),avalon.fn.mix({hasClass:function(a){var b=this[0]||{};return 1===b.nodeType&&lc(b).contains(a)},toggleClass:function(a,b){for(var c,g,d=0,e=String(a).split(/\s+/),f="boolean"==typeof b;c=e[d++];)g=f?b:!this.hasClass(c),this[g?"addClass":"removeClass"](c);return this},attr:function(a,b){return 2===arguments.length?(this[0].setAttribute(a,b),this):this[0].getAttribute(a)},data:function(a,b){var c,d;switch(a="data-"+ic(a||""),arguments.length){case 2:return this.attr(a,b),this;case 1:return c=this.attr(a),mc(c);case 0:return d={},r.forEach.call(this[0].attributes,function(b){b&&(a=b.name,a.indexOf("data-")||(a=jc(a.slice(5)),d[a]=mc(b.value)))}),d}},removeData:function(a){return a="data-"+ic(a),this[0].removeAttribute(a),this},css:function(a,b){var c,d;if(avalon.isPlainObject(a))for(c in a)avalon.css(this,c,a[c]);else d=avalon.css(this,a,b);return void 0!==d?d:this},position:function(){var a,b,c=this[0],d={top:0,left:0};if(c)return"fixed"===this.css("position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),"HTML"!==a[0].tagName&&(d=a.offset()),d.top+=avalon.css(a[0],"borderTopWidth",!0),d.left+=avalon.css(a[0],"borderLeftWidth",!0),d.top-=a.scrollTop(),d.left-=a.scrollLeft()),{top:b.top-d.top-avalon.css(c,"marginTop",!0),left:b.left-d.left-avalon.css(c,"marginLeft",!0)}},offsetParent:function(){for(var a=this[0].offsetParent;a&&"static"===avalon.css(a,"position");)a=a.offsetParent;return avalon(a||v)},bind:function(a,b,c){return this[0]?avalon.bind(this[0],a,b,c):void 0},unbind:function(a,b,c){return this[0]&&avalon.unbind(this[0],a,b,c),this},val:function(a){var c,d,e,f,b=this[0];if(b&&1===b.nodeType)if(c=0===arguments.length,d=c?":get":":set",e=Hc[Fc(b)+d])f=e(b,a);else{if(c)return(b.value||"").replace(/\r/g,"");b.value=a}return c?f:this}}),nc=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,oc=/^[\],:{}\s]*$/,pc=/(?:^|:|,)(?:\s*\[)+/g,qc=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,rc=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,avalon.parseJSON=a.JSON?JSON.parse:function(a){if("string"==typeof a){if(a=a.trim(),a&&oc.test(a.replace(qc,"@").replace(rc,"]").replace(pc,"")))return new Function("return "+a)();avalon.error("Invalid JSON: "+a)}return a},avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){avalon.fn[a]=function(c){var d=this[0]||{},e=sc(d),f="scrollTop"===a;return arguments.length?(e?e.scrollTo(f?avalon(e).scrollLeft():c,f?c:avalon(e).scrollTop()):d[a]=c,void 0):e?b in e?e[b]:v[a]:d[a]}}),tc=avalon.cssHooks={},uc=["","-webkit-","-o-","-moz-","-ms-"],vc={"float":u?"cssFloat":"styleFloat"},avalon.cssNumber=A("animationIterationCount,columnCount,order,flex,flexGrow,flexShrink,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(a,b,c){if(vc[a])return vc[a];b=b||v.style;for(var d=0,e=uc.length;e>d;d++)if(c=jc(uc[d]+a),c in b)return vc[a]=c;return null},tc["@:set"]=function(a,b,c){try{a.style[b]=c}catch(d){}},a.getComputedStyle?(tc["@:get"]=function(a,b){if(!a||!a.style)throw new Error("getComputedStyle要求传入一个节点 "+a);var c,d=getComputedStyle(a,null);return d&&(c="filter"===b?d.getPropertyValue(b):d[b],""===c&&(c=a.style[b])),c},tc["opacity:get"]=function(a){var b=tc["@:get"](a,"opacity");return""===b?"1":b}):(wc=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,xc=/^(top|right|bottom|left)$/,yc=/alpha\([^)]*\)/i,zc=!!a.XDomainRequest,Ac="DXImageTransform.Microsoft.Alpha",Bc={thin:zc?"1px":"2px",medium:zc?"3px":"4px",thick:zc?"5px":"6px"},tc["@:get"]=function(a,b){var e,f,g,c=a.currentStyle,d=c[b];return wc.test(d)&&!xc.test(d)&&(e=a.style,f=e.left,g=a.runtimeStyle.left,a.runtimeStyle.left=c.left,e.left="fontSize"===b?"1em":d||0,d=e.pixelLeft+"px",e.left=f,a.runtimeStyle.left=g),"medium"===d&&(b=b.replace("Width","Style"),"none"===c[b]&&(d="0px")),""===d?"auto":Bc[d]||d},tc["opacity:set"]=function(a,b,c){var d=a.style,e=isFinite(c)&&1>=c?"alpha(opacity="+100*c+")":"",f=d.filter||"";d.zoom=1,d.filter=(yc.test(f)?f.replace(yc,e):f+" "+e).trim(),d.filter||d.removeAttribute("filter")},tc["opacity:get"]=function(a){var b=a.filters.alpha||a.filters[Ac],c=b&&b.enabled?b.opacity:100;return c/100+""}),"top,left".replace(k,function(a){tc[a+":get"]=function(b){var c=tc["@:get"](b,a);return/px$/.test(c)?c:avalon(b).position()[a]+"px"}}),Cc={position:"absolute",visibility:"hidden",display:"block"},Dc=/^(none|table(?!-c[ea]).+)/,"Width,Height".replace(k,function(a){var b=a.toLowerCase(),c="client"+a,d="scroll"+a,e="offset"+a;tc[b+":get"]=function(b,c,d){var g,f=-4;return"number"==typeof d&&(f=d),c="Width"===a?["Left","Right"]:["Top","Bottom"],g=b[e],2===f?g+avalon.css(b,"margin"+c[0],!0)+avalon.css(b,"margin"+c[1],!0):(0>f&&(g=g-avalon.css(b,"border"+c[0]+"Width",!0)-avalon.css(b,"border"+c[1]+"Width",!0)),-4===f&&(g=g-avalon.css(b,"padding"+c[0],!0)-avalon.css(b,"padding"+c[1],!0)),g)},tc[b+"&get"]=function(a){var d,f,e,g,c=[];for(Ec(a,c),d=tc[b+":get"](a),e=0;f=c[e++];){a=f.node;for(g in f)"string"==typeof f[g]&&(a.style[g]=f[g])}return d},avalon.fn[b]=function(f){var h,g=this[0];return 0===arguments.length?g.setTimeout?g["inner"+a]||g.document.documentElement[c]||g.document.body[c]:9===g.nodeType?(h=g.documentElement,Math.max(g.body[d],h[d],g.body[e],h[e],h[c])):tc[b+"&get"](g):this.css(b,f)},avalon.fn["inner"+a]=function(){return tc[b+":get"](this[0],void 0,-2)},avalon.fn["outer"+a]=function(a){return tc[b+":get"](this[0],void 0,a===!0?2:0)}}),avalon.fn.offset=function(){var c,d,e,f,g,h,i,j,a=this[0],b={left:0,top:0};return a&&a.tagName&&a.ownerDocument?(c=a.ownerDocument,d=c.body,e=c.documentElement,f=c.defaultView||c.parentWindow,avalon.contains(e,a)?(a.getBoundingClientRect&&(b=a.getBoundingClientRect()),g=e.clientTop||d.clientTop,h=e.clientLeft||d.clientLeft,i=Math.max(f.pageYOffset||0,e.scrollTop,d.scrollTop),j=Math.max(f.pageXOffset||0,e.scrollLeft,d.scrollLeft),{top:b.top+i-g,left:b.left+j-h}):b):b},Gc=/^<option(?:\s+\w+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s+value[\s=]/i,Hc={"option:get":D?function(a){return Gc.test(a.outerHTML)?a.value:a.text.trim()}:function(a){return a.value},"select:get":function(a,b){for(var c,d=a.options,e=a.selectedIndex,f=Hc["option:get"],g="select-one"===a.type||0>e,h=g?null:[],i=g?e+1:d.length,j=0>e?i:g?e:0;i>j;j++)if(c=d[j],(c.selected||j===e)&&!c.disabled){if(b=f(c),g)return b;h.push(b)}return h},"select:set":function(a,b,c){var d,f,e;for(b=[].concat(b),d=Hc["option:get"],e=0;f=a.options[e++];)(f.selected=b.indexOf(d(f))>-1)&&(c=!0);c||(a.selectedIndex=-1)}},Ic={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},Jc=a.JSON&&JSON.stringify||function(a){return'"'+a.replace(/[\\\"\x00-\x1f]/g,function(a){var b=Ic[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"'},Kc=["break,case,catch,continue,debugger,default,delete,do,else,false","finally,for,function,if,in,instanceof,new,null,return,switch,this","throw,true,try,typeof,var,void,while,with","abstract,boolean,byte,char,class,const,double,enum,export,extends","final,float,goto,implements,import,int,interface,long,native","package,private,protected,public,short,static,super,synchronized","throws,transient,volatile","arguments,let,yield,undefined"].join(","),Lc=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,Mc=/[^\w$]+/g,Nc=new RegExp(["\\b"+Kc.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),Oc=/\b\d[^,]*/g,Pc=/^,+|,+$/g,Qc=new M(512),Rc=function(a){var d,b=","+a.trim(),c=Qc.get(b);return c?c:(d=a.replace(Lc,"").replace(Mc,",").replace(Nc,"").replace(Oc,"").replace(Pc,"").split(/^$|,+/),Qc.put(b,Tc(d)))},Uc=new M(128),Vc=/\w\[.*\]|\w\.\w/,Wc=/(\$proxy\$[a-z]+)\d+$/,Xc=/\)\s*$/,Yc=/\)\s*\|/g,Zc=/\|\s*([$\w]+)/g,$c=/"\s*\["/g,_c=/"\s*\(/g,avalon.parseExprProxy=dd,avalon.scan=function(a,b){a=a||v;var c=b?[].concat(b):[];Bd(a,c)},ed=A("area,base,basefont,br,col,command,embed,hr,img,input,link,meta,param,source,track,wbr,noscript,script,style,textarea".toUpperCase()),hd=function(a,b,c){var f,e,d=a.getAttribute(b);if(d)for(e=0;f=c[e++];)if(f.hasOwnProperty(d)&&"function"==typeof f[d])return f[d]},jd=D&&a.MutationObserver?function(a){for(var c,d,b=a.firstChild;b;)d=b.nextSibling,3===b.nodeType?c?(c.nodeValue+=b.nodeValue,a.removeChild(b)):c=b:c=null,b=d}:0,kd=/^\s*::/,ld=/ms-(\w+)-?(.*)/,md={"if":10,repeat:90,data:100,widget:110,each:1400,"with":1500,duplex:2e3,on:3e3},nd=A("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit"),od=A("value,title,alt,checked,selected,disabled,readonly,enabled"),rd=/^if|widget|repeat$/,sd=/^each|with|html|include$/,u||(td=new M(512),ud=/\s+(ms-[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,vd=/^['"]/,wd=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/i,xd=/&amp;/g,yd=function(a){var c,e,f,g,d,h,i,j,b=a.outerHTML;if("</"===b.slice(0,2)||!b.trim())return[];if(c=b.match(wd)[0],d=[],h=td.get(c))return h;for(;f=ud.exec(c);)g=f[2],g&&(g=(vd.test(g)?g.slice(1,-1):g).replace(xd,"&")),i=f[1].toLowerCase(),e=i.match(ld),j={name:i,specified:!0,value:g||""},d.push(j);return td.put(c,d)}),Cd=/\|\s*html(?:\b|$)/,Dd=/\|\|/g,Ed=/&lt;/g,Fd=/&gt;/g,Gd=/(['"])(\\\1|.)+?\1/g,Kd=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected","contentEditable,isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(","),Ld={},Kd.replace(k,function(a){Ld[a.toLowerCase()]=a}),Md={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"},Nd=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,frameBorder,longDesc,maxLength,marginWidth,marginHeight","rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(","),Nd.replace(k,function(a){Md[a.toLowerCase()]=a}),Od=/<noscript.*?>(?:[\s\S]+?)<\/noscript>/gim,Pd=/<noscript.*?>([\s\S]+?)<\/noscript>/im,Qd=function(){return new(a.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP")},Rd=avalon.templateCache={},J.attr=function(a,b){var e,f,c=cd(a.value.trim());"include"===a.type&&(e=a.element,a.includeRendered=hd(e,"data-include-rendered",b),a.includeLoaded=hd(e,"data-include-loaded",b),f=a.includeReplace=!!avalon(e).data("includeReplace"),avalon(e).data("includeCache")&&(a.templateCache={}),a.startInclude=d.createComment("ms-include"),a.endInclude=d.createComment("ms-include-end"),f?(a.element=a.startInclude,e.parentNode.insertBefore(a.startInclude,e),e.parentNode.insertBefore(a.endInclude,e.nextSibling)):(e.insertBefore(a.startInclude,e.firstChild),e.appendChild(a.endInclude))),a.handlerName="attr",dd(c,b,a)},K.attr=function(b,c,e){var i,j,k,l,n,o,p,q,r,s,t,w,x,y,z,A,B,C,g=e.type,h=e.param;if("css"===g)avalon(c).css(h,b);else if("attr"===g){if(i=b===!1||null===b||void 0===b,!u&&Md[h]&&(h=Md[h]),j=Ld[h],"boolean"==typeof c[j]&&(c[j]=!!b,b||(i=!0)),i)return c.removeAttribute(h);k=m.test(c)?!1:d.namespaces&&gc(c)?!0:h in c.cloneNode(!1),k?c[h]=b+"":c.setAttribute(h,b)}else if("include"===g&&b){if(l=e.vmodels,n=e.includeRendered,o=e.includeLoaded,p=e.includeReplace,q=p?c.parentNode:c,r=function(a){var c,g,h,i,j,k;for(o&&(c=o.apply(q,[a].concat(l)),"string"==typeof c&&(a=c)),n&&fd(q,function(){n.call(q)},0/0),g=e.includeLastID,e.templateCache&&g&&g!==b&&(h=e.templateCache[g],h||(h=e.templateCache[g]=d.createElement("div"),f.appendChild(h))),e.includeLastID=b;;){if(i=e.startInclude.nextSibling,!i||i===e.endInclude)break;q.removeChild(i),h&&h.appendChild(i)}j=Sd(e,b,a),k=avalon.slice(j.childNodes),q.insertBefore(j,e.endInclude),Ad(k,l)},"src"===e.param)"string"==typeof Rd[b]?avalon.nextTick(function(){r(Rd[b])}):Array.isArray(Rd[b])?Rd[b].push(r):(s=Qd(),s.onreadystatechange=function(){var a,c,e,d;if(4===s.readyState&&(a=s.status,a>=200&&300>a||304===a||1223===a)){for(c=s.responseText,d=0;e=Rd[b][d++];)e(c);Rd[b]=c}},Rd[b]=[r],s.open("GET",b,!0),"withCredentials"in s&&(s.withCredentials=!0),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.send(null));else if(t=b&&1===b.nodeType?b:d.getElementById(b)){if("NOSCRIPT"===t.tagName&&!t.innerHTML&&!t.fixIE78)for(s=Qd(),s.open("GET",location,!1),s.send(null),w=d.getElementsByTagName("noscript"),x=(s.responseText||"").match(Od)||[],y=x.length,z=0;y>z;z++)A=w[z],A&&(A.style.display="none",A.fixIE78=(x[z].match(Pd)||["","&nbsp;"])[1]);avalon.nextTick(function(){r(t.fixIE78||t.value||t.innerText||t.innerHTML)})}}else v.hasAttribute||"string"!=typeof b||"src"!==g&&"href"!==g||(b=b.replace(/&amp;/g,"&")),c[g]=b,a.chrome&&"EMBED"===c.tagName&&(B=c.parentNode,C=document.createComment("ms-src"),B.replaceChild(C,c),B.replaceChild(c,C))},"title,alt,src,value,css,include,href".replace(k,function(a){J[a]=J.attr}),J["class"]=function(a,b){var e,f,g,h,i,j,k,l,m,n,o,c=a.param,d=a.value;a.handlerName="class",!c||isFinite(c)?(a.param="",f=d.replace(fb,function(a){return a.replace(/./g,"0")}).indexOf(":"),-1===f?(g=d,e=!0):(g=d.slice(0,f),e=d.slice(f+1)),g=eb.test(d)?cd(g):Jc(g),a.expr="["+g+","+e+"]"):(a.expr="["+Jc(c)+","+d+"]",a.oldStyle=c),h=a.type,("hover"===h||"active"===h)&&(a.hasBindEvent||(i=a.element,j=avalon(i),k="mouseenter",l="mouseleave","active"===h&&(i.tabIndex=i.tabIndex||-1,k="mousedown",l="mouseup",m=j.bind("mouseleave",function(){a.toggleClass&&j.removeClass(a.newClass)}))),n=j.bind(k,function(){a.toggleClass&&j.addClass(a.newClass)}),o=j.bind(l,function(){a.toggleClass&&j.removeClass(a.newClass)}),a.rollback=function(){j.unbind("mouseleave",m),j.unbind(k,n),j.unbind(l,o)},a.hasBindEvent=!0),dd(a.expr,b,a)},K["class"]=function(a,b,c){var d=avalon(b);c.newClass=a[0],c.toggleClass=!!a[1],c.oldClass&&c.newClass!==c.oldClass&&d.removeClass(c.oldClass),c.oldClass=c.newClass,"class"===c.type&&(c.oldStyle?d.toggleClass(c.oldStyle,!!a[1]):d.toggleClass(c.newClass,c.toggleClass))},"hover,active".replace(k,function(a){J[a]=J["class"]}),K.data=function(a,b,c){var d="data-"+c.param;a&&"object"==typeof a?b[d]=a:b.setAttribute(d,String(a))},Td=J.duplex=function(a,b){var d,e,f,g,i,j,k,c=a.element;if(dd(a.value,b,a,1),a.changed=hd(c,"data-duplex-changed",b)||z,a.evaluator&&a.args){e=[],f=A("string,number,boolean,checked"),"radio"===c.type&&""===a.param&&(a.param="checked"),c.msData&&(c.msData["ms-duplex"]=a.value),a.param.replace(/\w+/g,function(b){/^(checkbox|radio)$/.test(c.type)&&/^(radio|checked)$/.test(b)&&("radio"===b&&h("ms-duplex-radio已经更名为ms-duplex-checked"),b="checked",a.isChecked=!0),"bool"===b?(b="boolean",h("ms-duplex-bool已经更名为ms-duplex-boolean")):"text"===b&&(b="string",h("ms-duplex-text已经更名为ms-duplex-string")),f[b]&&(d=!0),avalon.Array.ensure(e,b)}),d||e.push("string"),a.param=e.join("-"),a.bound=function(b,d){c.addEventListener?c.addEventListener(b,d,!1):c.attachEvent("on"+b,d);var e=a.rollback;a.rollback=function(){c.avalonSetter=null,avalon.unbind(c,b,d),e&&e()}};for(g in avalon.vmodels)i=avalon.vmodels[g],i.$fire("avalon-ms-duplex-init",a);j=a.pipe||(a.pipe=Vd),j(null,a,"init"),k=c.tagName,Td[k]&&Td[k](c,a.evaluator.apply(null,a.args),a)}},avalon.duplexHooks={checked:{get:function(a,b){return!b.element.oldValue}},string:{get:function(a){return a},set:Ud},"boolean":{get:function(a){return"true"===a},set:Ud},number:{get:function(a,b){var d,c=parseFloat(a);if(-a===-c)return c;switch(d=/strong|medium|weak/.exec(b.element.getAttribute("data-duplex-number"))||["medium"],d[0]){case"strong":return 0;case"medium":return""===a?"":0;case"weak":return a}},set:Ud}},Xd=[],avalon.tick=function(a){1===Xd.push(a)&&(Wd=setInterval(Yd,60))},Zd=z,new function(){function d(b){a[this.tagName].call(this,b),!this.msFocus&&this.avalonSetter&&this.oldValue!==b&&this.avalonSetter()}var a,b,c,e;try{a={},b=HTMLInputElement.prototype,c=HTMLTextAreaElement.prototype,e=HTMLInputElement.prototype,Object.getOwnPropertyNames(e),a["INPUT"]=Object.getOwnPropertyDescriptor(b,"value").set,Object.defineProperty(b,"value",{set:d}),a["TEXTAREA"]=Object.getOwnPropertyDescriptor(c,"value").set,Object.defineProperty(c,"value",{set:d})}catch(f){Zd=avalon.tick}},D&&avalon.bind(d,"selectionchange",function(){var b=d.activeElement;b&&"function"==typeof b.avalonSetter&&b.avalonSetter()}),Td.INPUT=function(a,b,c){function i(a){c.changed.call(this,a,c)}function j(){g=!0}function l(){g=!1}function p(a){setTimeout(function(){m(a)})}var n,o,d=a.type,e=c.bound,f=avalon(a),g=!1,m=function(){var e,d=a.value;g||d===a.oldValue||(e=c.pipe(d,c,"get"),f.data("duplexObserve")!==!1&&(b(e),i.call(a,e)))};c.handler=function(){var d=c.pipe(b(),c,"set");d!==a.oldValue&&(a.value=a.oldValue=d)},c.isChecked||"radio"===d?(n=6===D,m=function(){if(f.data("duplexObserve")!==!1){var d=c.pipe(a.value,c,"get");b(d),i.call(a,d)}},c.handler=function(){var d=b(),e=c.isChecked?!!d:d+""===a.value;a.oldValue=e,n?setTimeout(function(){a.defaultChecked=e,a.checked=e},31):a.checked=e},e("click",m)):"checkbox"===d?(m=function(){var d,e,g;f.data("duplexObserve")!==!1&&(d=a.checked?"ensure":"remove",e=b(),Array.isArray(e)||(h("ms-duplex应用于checkbox上要对应一个数组"),e=[e]),g=c.pipe(a.value,c,"get"),avalon.Array[d](e,g),i.call(a,e))},c.handler=function(){var d=[].concat(b()),e=c.pipe(a.value,c,"get");a.checked=d.indexOf(e)>-1},e(u?"change":"click",m)):(o=a.getAttribute("data-duplex-event")||"input",a.attributes["data-event"]&&h("data-event指令已经废弃，请改用data-duplex-event"),o.replace(k,function(a){switch(a){case"input":D?(D>8?e("input",m):e("propertychange",function(a){"value"===a.propertyName&&m()}),e("dragend",p)):(e("input",m),e("compositionstart",j),e("compositionend",l),e("DOMAutoComplete",m));break;default:e(a,m)}}),e("focus",function(){a.msFocus=!0}),e("blur",function(){a.msFocus=!1}),/^(file|button|reset|submit|checkbox|radio)$/.test(a.type)||(a.avalonSetter=m,Zd(function(){if(v.contains(a))a.msFocus||a.oldValue===a.value||m();else if(!a.msRetain)return!1}))),avalon.injectBinding(c),i.call(a,a.value)},Td.TEXTAREA=Td.INPUT,Td.SELECT=function(a,b,c){function e(){if(d.data("duplexObserve")!==!1){var e=d.val();e=Array.isArray(e)?e.map(function(a){return c.pipe(a,c,"get")}):c.pipe(e,c,"get"),e+""!==a.oldValue&&b(e),c.changed.call(a,e,c)}}var d=avalon(a);c.handler=function(){var c=b();c=c&&c.$model||c,Array.isArray(c)?a.multiple||h("ms-duplex在<select multiple=true>上要求对应一个数组"):a.multiple&&h("ms-duplex在<select multiple=false>不能对应一个数组"),c=Array.isArray(c)?c.map(String):c+"",c+""!==a.oldValue&&(d.val(c),a.oldValue=c+"")},c.bound("change",e),a.msCallback=function(){avalon.injectBinding(c),c.changed.call(a,b(),c)}},K.html=function(a,b,c){var g,h,i,j,k,e=1!==b.nodeType,f=e?b.parentNode:b;if(f&&(a=null==a?"":a,c.oldText!==a)){if(c.oldText=a,3===b.nodeType&&(g=B("html"),f.insertBefore(d.createComment(g),b),c.element=d.createComment(g+":end"),f.replaceChild(c.element,b),b=c.element),"object"!=typeof a)h=avalon.parseHTML(String(a));else if(11===a.nodeType)h=a;else if(1===a.nodeType||a.item)for(i=1===a.nodeType?a.childNodes:a.item,h=w.cloneNode(!0);i[0];)h.appendChild(i[0]);if(i=avalon.slice(h.childNodes),e){for(j=b.nodeValue.slice(0,-4);;){if(k=b.previousSibling,!k||8===k.nodeType&&k.nodeValue===j)break;f.removeChild(k)}f.insertBefore(h,b)}else avalon.clearHTML(b).appendChild(h);Ad(i,c.vmodels)}},J["if"]=J.data=J.text=J.html=function(a,b){dd(a.value,b,a)},K["if"]=function(a,b,c){try{if(!b.parentNode)return}catch(e){return}if(a)8===b.nodeType&&(b.parentNode.replaceChild(c.template,b),b.ifRemove=null,b=c.element=c.template),b.getAttribute(c.name)&&(b.removeAttribute(c.name),qd(b,c.vmodels)),c.rollback=null;else if(1===b.nodeType){var g=c.element=d.createComment("ms-if");b.parentNode.replaceChild(g,b),b.ifRemove=g,c.template=b,f.appendChild(b),c.rollback=function(){b.parentNode===f&&f.removeChild(b)}}},$d=/\(([^)]*)\)/,J.on=function(a,b){var d,e,c=a.value;a.type="on",d=a.param.replace(/-\d+$/,""),"function"==typeof J.on[d+"Hook"]&&J.on[d+"Hook"](a),c.indexOf("(")>0&&c.indexOf(")")>-1&&(e=(c.match($d)||["",""])[1].trim(),(""===e||"$event"===e)&&(c=c.replace($d,""))),dd(c,b,a)},K.on=function(a,b,c){var d,e;a=function(a){var b=c.evaluator||z;return b.apply(this,c.args.concat(a))},d=c.param.replace(/-\d+$/,""),"scan"===d?a.call(b,{type:d}):"function"==typeof c.specialBind?c.specialBind(b,a):e=avalon.bind(b,d,a),c.rollback=function(){"function"==typeof c.specialUnbind?c.specialUnbind():avalon.unbind(b,d,e)}},J.repeat=function(a,b){var e,f,g,j,k,m,l,n,o,p,q,r,s,t,u,v,x,c=a.type;dd(a.value,b,a,1),a.proxies=[],e=!1;try{f=a.$repeat=a.evaluator.apply(0,a.args||[]),g=avalon.type(f),"object"!==g&&"array"!==g?(e=!0,avalon.log("warning:"+a.value+"只能是对象或数组")):a.xtype=g}catch(h){e=!0}if(j=a.value.split(".")||[],j.length>1)for(j.pop(),k=j[0],l=0;m=b[l++];)if(m&&m.hasOwnProperty(k)){n=m[k].$events||{},n[i]=n[i]||[],n[i].push(a);break}if(a.handler=z,avalon.injectBinding(a),o=a.element,1===o.nodeType){if(o.removeAttribute(a.name),a.sortedCallback=hd(o,"data-with-sorted",b),a.renderedCallback=hd(o,"data-"+c+"-rendered",b),p=B(c),q=d.createComment(p),r=d.createComment(p+":end"),a.signature=p,a.template=w.cloneNode(!1),"repeat"===c)s=o.parentNode,s.replaceChild(r,o),s.insertBefore(q,r),a.template.appendChild(o);else{for(;o.firstChild;)a.template.appendChild(o.firstChild);o.appendChild(q),o.appendChild(r)}a.element=r,a.handler=K.repeat,a.rollback=function(){var b=a.element;b&&a.handler("clear")}}if(!e){for(a.$outer={},t="$key",u="$val",Array.isArray(f)&&(t="$first",u="$last"),l=0;m=b[l++];)if(m.hasOwnProperty(t)&&m.hasOwnProperty(u)){a.$outer=m;break}v=f.$events,x=(v||{})[i],Pb(x,a),"object"===g?a.handler("append"):f.length&&a.handler("add",0,f.length)}},K.repeat=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,v,u,x,y,A,B,C,D,E,F,d=this;if(!a&&d.xtype)if(e=d.$repeat,f=d.evaluator.apply(0,d.args||[]),"array"===d.xtype){if(e.length===f.length){if(!(e!==f&&e.length>0))return;K.repeat.call(this,"clear",b,c)}a="add",b=0,d.$repeat=f,c=f.length}else{if(Db(e).join(";;")===Db(f).join(";;"))return;a="append",d.$repeat=f}if(a){switch(i=d.element,j=ae(d),k=i.parentNode,l=d.proxies,m=w.cloneNode(!1),a){case"add":for(n=b+c,o=[],p=b;n>p;p++)q=je(p,d),l.splice(p,0,q),_d(d,m,q,o);for(k.insertBefore(m,j[b]||i),p=0;h=o[p++];)Ad(h.nodes,h.vmodels),h.nodes=h.vmodels=null;break;case"del":be(j[b],j[b+c]||i),r=l.splice(b,c),fe(r,"each");break;case"clear":g=j[0],g&&(be(g,i),"object"===d.xtype?k.insertBefore(g,i):fe(l,"each"));break;case"move":if(g=j[0]){for(s=g.nodeValue,t=[],u=[],be(g,i,function(){u.unshift(this),this.nodeValue===s&&(t.unshift(u),u=[])}),Mb(t,b),Mb(l,b);u=t.shift();)for(;v=u.shift();)m.appendChild(v);k.insertBefore(m,i)}break;case"index":for(x=l.length-1;c=l[b];b++)c.$index=b,c.$first=0===b,c.$last=b===x;return;case"set":q=l[b],q&&Qb(q.$events[d.param||"el"]);break;case"append":y=d.$repeat,A=Array.isArray(l)||!l?{}:l,d.proxies=A,B=[],o=[];for(C in A)y.hasOwnProperty(C)||(ke(A[C],ce),delete A[C]);for(C in y)y.hasOwnProperty(C)&&"hasOwnProperty"!==C&&B.push(C);for(d.sortedCallback&&(D=d.sortedCallback.call(k,B),D&&Array.isArray(D)&&D.length&&(B=D)),p=0;C=B[p++];)"hasOwnProperty"!==C&&(A[C]=ee(A[C],C,d),_d(d,m,A[C],o));for(k.insertBefore(m,i),p=0;h=o[p++];)Ad(h.nodes,h.vmodels),h.nodes=h.vmodels=null}if(!d.$repeat||d.$repeat.hasOwnProperty("$lock"))return;"clear"===a&&(a="del"),E=d.renderedCallback||z,F=arguments,k.oldValue&&"SELECT"===k.tagName&&avalon(k).val(k.oldValue.split(",")),E.apply(k,F)}},"with,each".replace(k,function(a){J[a]=J.repeat}),ce=[],he=[],K.text=function(a,b){if(a=null==a?"":a,3===b.nodeType)try{b.data=a}catch(c){}else"textContent"in b?b.textContent=a:b.innerText=a},avalon.parseDisplay=le,J.visible=function(a,b){dd(a.value,b,a)},K.visible=function(a,b,c){a?(b.style.display=c.display||"","none"===avalon(b).css("display")&&(b.style.display=c.display=le(b.nodeName))):b.style.display="none"},J.widget=function(b,c){var i,j,m,l,n,o,p,q,r,d=b.value.match(k),e=b.element,f=d[0],g=d[1];if(g&&"$"!==g||(g=B(f)),i=d[2]||f,j=avalon.ui[f],"function"==typeof j){for(c=e.vmodels||c,l=0;m=c[l++];)if(m.hasOwnProperty(i)&&"object"==typeof m[i]){n=m[i],n=n.$model||n;break}if(n&&(o=n[f+"Id"],"string"==typeof o&&(h("warning!不再支持"+f+"Id"),g=o)),p=avalon.getWidgetData(e,f),b.value=[f,g,i].join(","),b[f+"Id"]=g,b.evaluator=z,e.msData["ms-widget-id"]=g,q=b[f+"Options"]=avalon.mix({},j.defaults,n||{},p),e.removeAttribute("ms-widget"),r=j(e,b,c)||{},r.$id){avalon.vmodels[g]=r,gd(e,r);try{r.$init(function(){avalon.scan(e,[r].concat(c)),"function"==typeof q.onInit&&q.onInit.call(e,r,q,c)})}catch(s){}b.rollback=function(){try{r.$remove(),r.widgetElement=null}catch(a){}e.msData={},delete avalon.vmodels[r.$id]},Wb(b,me),a.chrome&&e.addEventListener("DOMNodeRemovedFromDocument",function(){setTimeout(Xb)})}else avalon.scan(e,c)}else c.length&&(e.vmodels=c)},me=[],ne=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,oe=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,pe=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,qe={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi},re=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,se=/([^\#-~| |!])/g,ue=avalon.filters={uppercase:function(a){return a.toUpperCase()},lowercase:function(a){return a.toLowerCase()},truncate:function(a,b,c){return b=b||30,c="string"==typeof c?c:"...",a.length>b?a.slice(0,b-c.length)+c:String(a)},$filter:function(a){var b,c,d,e,f;for(b=1,c=arguments.length;c>b;b++)d=arguments[b],e=avalon.filters[d[0]],"function"==typeof e&&(f=[a].concat(d.slice(1)),a=e.apply(null,f));return a},camelize:jc,sanitize:function(a){return a.replace(ne,"").replace(pe,function(a){var d,c=a.toLowerCase().match(/<(\w+)\s/);return c&&(d=qe[c[1]],d&&(a=a.replace(d,function(a,b,c){var d=c.charAt(0);return b+"="+d+"javascript:void(0)"+d}))),a.replace(oe," ").replace(/\s+/g," ")})},escape:function(a){return String(a).replace(/&/g,"&amp;").replace(re,function(a){var b=a.charCodeAt(0),c=a.charCodeAt(1);return"&#"+(1024*(b-55296)+(c-56320)+65536)+";"}).replace(se,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")},currency:function(a,b,c){return(b||"￥")+te(a,isFinite(c)?c:2)},number:te},new function(){function a(a){return parseInt(a,10)||0}function b(a,b,c){var d="";for(0>a&&(d="-",a=-a),a=""+a;a.length<b;)a="0"+a;return c&&(a=a.substr(a.length-b)),d+a}function c(a,c,d,e){return function(f){var g=f["get"+a]();return(d>0||g>-d)&&(g+=d),0===g&&-12===d&&(g=12),b(g,c,e)}}function d(a,b){return function(c,d){var e=c["get"+a](),f=(b?"SHORT"+a:a).toUpperCase();return d[f][e]}}function e(a){var c=-1*a.getTimezoneOffset(),d=c>=0?"+":"";return d+=b(Math[c>0?"floor":"ceil"](c/60),2)+b(Math.abs(c%60),2)}function f(a,b){return a.getHours()<12?b.AMPMS[0]:b.AMPMS[1]}var j,g={yyyy:c("FullYear",4),yy:c("FullYear",2,0,!0),y:c("FullYear",1),MMMM:d("Month"),MMM:d("Month",!0),MM:c("Month",2,1),M:c("Month",1,1),dd:c("Date",2),d:c("Date",1),HH:c("Hours",2),H:c("Hours",1),hh:c("Hours",2,-12),h:c("Hours",1,-12),mm:c("Minutes",2),m:c("Minutes",1),ss:c("Seconds",2),s:c("Seconds",1),sss:c("Milliseconds",3),EEEE:d("Day"),EEE:d("Day",!0),a:f,Z:e},h=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,i=/^\/Date\((\d+)\)\/$/;ue.date=function(b,c){var j,k,l,m,n,o,p,q,r,d=ue.date.locate,e="",f=[];if(c=c||"mediumDate",c=d[c]||c,"string"==typeof b&&(/^\d+$/.test(b)?b=a(b):i.test(b)?b=+RegExp.$1:(l=b.trim(),m=[0,0,0,0,0,0,0],n=new Date(0),l=l.replace(/^(\d+)\D(\d+)\D(\d+)/,function(b,c,d,e){var f=4===e.length?[e,c,d]:[c,d,e];
      return m[0]=a(f[0]),m[1]=a(f[1])-1,m[2]=a(f[2]),""}),o=n.setFullYear,p=n.setHours,l=l.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(b,c,d,e,f){return m[3]=a(c),m[4]=a(d),m[5]=a(e),f&&(m[6]=Math.round(1e3*parseFloat("0."+f))),""}),q=0,r=0,l=l.replace(/Z|([+-])(\d\d):?(\d\d)/,function(b,c,d,e){return o=n.setUTCFullYear,p=n.setUTCHours,c&&(q=a(c+d),r=a(c+e)),""}),m[3]-=q,m[4]-=r,o.apply(n,m.slice(0,3)),p.apply(n,m.slice(3)),b=n)),"number"==typeof b&&(b=new Date(b)),"date"===avalon.type(b)){for(;c;)k=h.exec(c),k?(f=f.concat(k.slice(1)),c=f.pop()):(f.push(c),c=null);return f.forEach(function(a){j=g[a],e+=j?j(b,d):a.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),e}},j={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"},j.SHORTMONTH=j.MONTH,ue.date.locate=j},new function(){function e(c){for(b=1;c=a.shift();)c()}var c,a,b,f;avalon.config({loader:!1}),a=[],b="complete"===d.readyState,avalon.bind(d,"DOMContentLoaded",c=function(){avalon.unbind(d,"DOMContentLoaded",c),e()}),f=setInterval(function(){"complete"===document.readyState&&document.body&&(clearInterval(f),e())},50),avalon.ready=function(c){b?c(avalon):a.push(c)},avalon.ready(function(){avalon.scan(d.body)})},"function"==typeof define&&define.amd&&define("avalon",[],function(){return avalon}),ve=a.avalon,avalon.noConflict=function(b){return b&&a.avalon===avalon&&(a.avalon=ve),avalon},void 0===b&&(a.avalon=avalon),avalon});